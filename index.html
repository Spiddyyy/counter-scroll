<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="Dzm-kvpjDZb_0yO1gvZx44Kz0J2aSIzJ1HwdyUSREx0" />
    <title>Enhanced ScrollCounter Library Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
        }
        
        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .section {
            padding: 80px 0;
            background: white;
        }
        
        .section:nth-child(even) {
            background: #f8f9fa;
        }
        
        .section h2 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: #2c3e50;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }
        
        .demo-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .demo-card:hover {
            transform: translateY(-5px);
        }
        
        .demo-card h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }
        
        .counter-value {
            font-size: 3rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 20px 0;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .demo-card p {
            color: #666;
            margin-top: 15px;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .stats-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .controls {
            text-align: center;
            margin: 40px 0;
        }
        
        .btn {
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 1rem;
            transition: background 0.3s ease;
        }
        
        .btn:hover {
            background: #5a6fd8;
        }
        
        .btn-secondary {
            background: #95a5a6;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .feature-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .feature-item h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="hero">
        <div>
            <h1>Enhanced ScrollCounter</h1>
            <p>Powerful, flexible, and developer-friendly scroll animations</p>
        </div>
    </div>

    <div class="section">
        <div class="container">
            <h2>Basic Counters</h2>
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>Simple Counter</h3>
                    <div class="counter-value" data-count="1250">0</div>
                    <p>Basic counting animation</p>
                </div>
                
                <div class="demo-card">
                    <h3>With Prefix & Suffix</h3>
                    <div class="counter-value" data-count="95" data-prefix="%" data-suffix="">0</div>
                    <p>Custom prefix and suffix</p>
                </div>
                
                <div class="demo-card">
                    <h3>Slow Animation</h3>
                    <div class="counter-value" data-count="500" data-duration="4000" data-easing="easeOutBack">0</div>
                    <p>4 second duration with back easing</p>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="container">
            <h2>Currency & Formatting</h2>
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>Currency</h3>
                    <div class="counter-value" data-count="1599.99" data-currency="true" data-decimals="2">$0.00</div>
                    <p>Automatic currency formatting</p>
                </div>
                
                <div class="demo-card">
                    <h3>Thousands Separator</h3>
                    <div class="counter-value" data-count="1234567" data-grouping="true">0</div>
                    <p>Comma-separated thousands</p>
                </div>
                
                <div class="demo-card">
                    <h3>Decimals</h3>
                    <div class="counter-value" data-count="98.76" data-decimals="2">0.00</div>
                    <p>Two decimal places</p>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="container">
            <h2>Advanced Features</h2>
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>Abbreviations</h3>
                    <div class="counter-value" data-count="1500000" data-abbreviate="true">0</div>
                    <p>Shows as 1.5M automatically</p>
                </div>
                
                <div class="demo-card">
                    <h3>Custom Step</h3>
                    <div class="counter-value" data-count="100" data-step="5">0</div>
                    <p>Counts by 5s: 0, 5, 10, 15...</p>
                </div>
                
                <div class="demo-card">
                    <h3>Bounce Easing</h3>
                    <div class="counter-value" data-count="42" data-easing="bounce">0</div>
                    <p>Fun bounce animation</p>
                </div>
            </div>
        </div>
    </div>

    <div class="section stats-section">
        <div class="container">
            <h2 style="color: white;">Company Statistics</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="counter-value stat-number" data-count="10500" data-suffix="+" data-abbreviate="true">0</div>
                    <div class="stat-label">Happy Customers</div>
                </div>
                
                <div class="stat-item">
                    <div class="counter-value stat-number" data-count="2400000" data-currency="true" data-abbreviate="true">$0</div>
                    <div class="stat-label">Revenue Generated</div>
                </div>
                
                <div class="stat-item">
                    <div class="counter-value stat-number" data-count="99.9" data-decimals="1" data-suffix="%">0%</div>
                    <div class="stat-label">Uptime</div>
                </div>
                
                <div class="stat-item">
                    <div class="counter-value stat-number" data-count="150" data-suffix="+" data-easing="easeOutQuint">0</div>
                    <div class="stat-label">Team Members</div>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="container">
            <h2>Manual Controls</h2>
            <div class="controls">
                <button class="btn" onclick="counter.trigger()">Trigger All</button>
                <button class="btn btn-secondary" onclick="counter.reset()">Reset All</button>
                <button class="btn" onclick="counter.trigger('.manual-counter')">Trigger Manual Only</button>
            </div>
            
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>Manual Trigger</h3>
                    <div class="counter-value manual-counter" data-count="888" data-easing="easeInOutBack">0</div>
                    <p>Click "Trigger Manual Only" to animate</p>
                </div>
                
                <div class="demo-card">
                    <h3>Replay Enabled</h3>
                    <div class="counter-value" data-count="777" data-threshold="0.8">0</div>
                    <p>Scroll up and down to see replay</p>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="container">
            <h2>New Features</h2>
            <div class="feature-list">
                <div class="feature-item">
                    <h4>✨ Decimal Support</h4>
                    <p>Count with any number of decimal places</p>
                </div>
                
                <div class="feature-item">
                    <h4>💰 Currency Formatting</h4>
                    <p>Automatic currency symbols and separators</p>
                </div>
                
                <div class="feature-item">
                    <h4>📈 Abbreviations</h4>
                    <p>Smart K/M/B/T abbreviations for large numbers</p>
                </div>
                
                <div class="feature-item">
                    <h4>🎯 Custom Steps</h4>
                    <p>Count by any increment: 2s, 5s, 10s, etc.</p>
                </div>
                
                <div class="feature-item">
                    <h4>🌊 Advanced Easing</h4>
                    <p>15+ easing functions including bounce and back</p>
                </div>
                
                <div class="feature-item">
                    <h4>🎮 Manual Controls</h4>
                    <p>Trigger, reset, and control animations via JavaScript</p>
                </div>
                
                <div class="feature-item">
                    <h4>📱 Performance</h4>
                    <p>Throttled scroll events and memory cleanup</p>
                </div>
                
                <div class="feature-item">
                    <h4>🔧 Developer Friendly</h4>
                    <p>Callbacks, TypeScript ready, and modular</p>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="container">
            <h2>Usage Examples</h2>
            
            <h3>Basic Setup</h3>
            <div class="code-block">
// Simple initialization
const counter = new ScrollCounter('.counter-value', {
    duration: 2000,
    easing: 'easeOutQuart',
    decimals: 0,
    currency: false
});
            </div>

            <h3>Advanced Configuration</h3>
            <div class="code-block">
// Advanced setup with callbacks
const counter = new ScrollCounter('.stats-counter', {
    duration: 3000,
    easing: 'easeOutBack',
    decimals: 2,
    currency: true,
    currencySymbol: '€',
    separator: '.',
    decimal: ',',
    abbreviate: true,
    onStart: (element, startValue, targetValue) => {
        console.log('Animation started!');
    },
    onComplete: (element, finalValue) => {
        console.log('Animation completed!');
    }
});
            </div>

            <h3>HTML Data Attributes</h3>
            <div class="code-block">
&lt;div class="counter-value" 
     data-count="1500000"
     data-duration="3000"
     data-easing="bounce"
     data-decimals="1"
     data-abbreviate="true"
     data-currency="true"
     data-threshold="0.5"&gt;
  $0
&lt;/div&gt;
            </div>
        </div>
    </div>

    <script>
        // Enhanced ScrollCounter Library
        class ScrollCounter {
            constructor(selector = '.counter-value', options = {}) {
                this.selector = selector;
                this.defaultOptions = {
                    duration: 2000,
                    easing: 'easeOutQuart',
                    once: true,
                    replay: false,
                    prefix: '',
                    suffix: '',
                    decimals: 0,
                    separator: ',',
                    decimal: '.',
                    step: 1,
                    useGrouping: true,
                    currency: false,
                    currencySymbol:'',
                    abbreviate: false,
                    onStart: null,
                    onUpdate: null,
                    onComplete: null,
                };
                this.options = { ...this.defaultOptions, ...options };
                this.observed = new Set();
                this.animating = new Set();
                this.init();
            }

            init() {
                if ('IntersectionObserver' in window) {
                    this.observer = new IntersectionObserver(
                        this.handleIntersect.bind(this),
                        { threshold: [0.1, 0.25, 0.5, 0.75, 1.0] }
                    );

                    document.querySelectorAll(this.selector).forEach((el) => {
                        this.setupElement(el);
                        this.observer.observe(el);
                    });
                } else {
                    window.addEventListener('scroll', this.throttle(this.handleScrollFallback.bind(this), 16));
                }
            }

            setupElement(el) {
                const originalText = el.textContent;
                const originalNumber = this.extractNumber(originalText);
                
                el.dataset.originalValue = originalNumber.toString();
                el.dataset.originalText = originalText;
                
                // Set initial display
                el.textContent = this.formatNumber(originalNumber, el);
            }

            extractNumber(text) {
                // Extract number from text, handling various formats
                const cleaned = text.replace(/[^\d.-]/g, '');
                const number = parseFloat(cleaned) || 0;
                return number;
            }

            handleScrollFallback() {
                document.querySelectorAll(this.selector).forEach((el) => {
                    const rect = el.getBoundingClientRect();
                    const threshold = this.getThreshold(el);
                    const viewportHeight = window.innerHeight;
                    const elementHeight = rect.height;
                    const visibleHeight = Math.min(rect.bottom, viewportHeight) - Math.max(rect.top, 0);
                    const visibilityRatio = visibleHeight / elementHeight;

                    if (visibilityRatio >= threshold && (!this.options.once || !this.observed.has(el))) {
                        this.animateCounter(el);
                        if (this.options.once) this.observed.add(el);
                    }
                });
            }

            handleIntersect(entries) {
                entries.forEach((entry) => {
                    const el = entry.target;
                    const threshold = this.getThreshold(el);

                    if (entry.isIntersecting && entry.intersectionRatio >= threshold) {
                        if (!this.options.replay && this.observed.has(el)) return;
                        if (this.animating.has(el)) return; // Prevent overlapping animations

                        // Reset if replay is enabled
                        if (this.options.replay && this.observed.has(el)) {
                            const original = parseFloat(el.dataset.originalValue || "0");
                            el.textContent = this.formatNumber(original, el);
                        }

                        this.animateCounter(el);
                        if (this.options.once) this.observed.add(el);
                    } else if (this.options.replay && !entry.isIntersecting) {
                        this.observed.delete(el);
                    }
                });
            }

            getThreshold(el) {
                return parseFloat(el.getAttribute('data-threshold')) || 0.6;
            }

            animateCounter(el) {
                if (this.animating.has(el)) return;
                
                const target = parseFloat(el.getAttribute('data-count')) || parseFloat(el.dataset.originalValue) || 0;
                const start = parseFloat(el.dataset.originalValue) || 0;
                const duration = parseInt(el.getAttribute('data-duration')) || this.options.duration;
                const easing = this.getEasing(el.getAttribute('data-easing') || this.options.easing);
                const step = parseFloat(el.getAttribute('data-step')) || this.options.step;

                this.animating.add(el);
                
                // Trigger onStart callback
                if (typeof this.options.onStart === 'function') {
                    this.options.onStart(el, start, target);
                }

                const startTime = performance.now();

                const animate = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const easedProgress = easing(progress);
                    
                    let value;
                    if (step === 1) {
                        value = start + (target - start) * easedProgress;
                    } else {
                        value = Math.floor((start + (target - start) * easedProgress) / step) * step;
                    }

                    el.textContent = this.formatNumber(value, el);

                    // Trigger onUpdate callback
                    if (typeof this.options.onUpdate === 'function') {
                        this.options.onUpdate(el, value, progress);
                    }

                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    } else {
                        el.textContent = this.formatNumber(target, el);
                        this.animating.delete(el);
                        
                        // Trigger onComplete callback
                        if (typeof this.options.onComplete === 'function') {
                            this.options.onComplete(el, target);
                        }
                    }
                };

                requestAnimationFrame(animate);
            }

            formatNumber(value, el) {
                const decimals = parseInt(el.getAttribute('data-decimals')) ?? this.options.decimals;
                const separator = el.getAttribute('data-separator') || this.options.separator;
                const decimal = el.getAttribute('data-decimal') || this.options.decimal;
                const prefix = el.getAttribute('data-prefix') || this.options.prefix;
                const suffix = el.getAttribute('data-suffix') || this.options.suffix;
                const useGrouping = el.getAttribute('data-grouping') !== 'false' && this.options.useGrouping;
                const currency = el.getAttribute('data-currency') === 'true' || this.options.currency;
                const currencySymbol = el.getAttribute('data-currency-symbol') || this.options.currencySymbol;
                const abbreviate = el.getAttribute('data-abbreviate') === 'true' || this.options.abbreviate;

                let formattedValue = value;

                // Handle abbreviations (K, M, B, T)
                if (abbreviate) {
                    formattedValue = this.abbreviateNumber(value, decimals);
                } else {
                    // Round to specified decimals
                    formattedValue = Number(value.toFixed(decimals));

                    // Add thousand separators if enabled
                    if (useGrouping) {
                        const parts = formattedValue.toString().split('.');
                        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, separator);
                        formattedValue = parts.join(decimal);
                    } else if (decimals > 0) {
                        formattedValue = formattedValue.toString().replace('.', decimal);
                    }
                }

                // Apply currency formatting
                if (currency) {
                    return `${currencySymbol}${formattedValue}`;
                }

                // Apply prefix and suffix
                return `${prefix}${formattedValue}${suffix}`;
            }

            abbreviateNumber(value, decimals = 1) {
                const suffixes = ['', 'K', 'M', 'B', 'T'];
                const tier = Math.floor(Math.log10(Math.abs(value)) / 3);
                
                if (tier === 0) return value.toFixed(decimals);
                
                const suffix = suffixes[tier];
                const scale = Math.pow(10, tier * 3);
                const scaled = value / scale;
                
                return scaled.toFixed(decimals) + suffix;
            }

            getEasing(type) {
                const easings = {
                    linear: (t) => t,
                    easeIn: (t) => t * t,
                    easeOut: (t) => t * (2 - t),
                    easeInOut: (t) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t),
                    easeInQuad: (t) => t * t,
                    easeOutQuad: (t) => t * (2 - t),
                    easeInOutQuad: (t) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t),
                    easeInCubic: (t) => t * t * t,
                    easeOutCubic: (t) => (--t) * t * t + 1,
                    easeInOutCubic: (t) => t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,
                    easeInQuart: (t) => t * t * t * t,
                    easeOutQuart: (t) => 1 - (--t) * t * t * t,
                    easeInOutQuart: (t) => t < 0.5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t,
                    easeInQuint: (t) => t * t * t * t * t,
                    easeOutQuint: (t) => 1 + (--t) * t * t * t * t,
                    easeInOutQuint: (t) => t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t,
                    easeInSine: (t) => 1 - Math.cos(t * Math.PI / 2),
                    easeOutSine: (t) => Math.sin(t * Math.PI / 2),
                    easeInOutSine: (t) => -(Math.cos(Math.PI * t) - 1) / 2,
                    easeInExpo: (t) => t === 0 ? 0 : Math.pow(2, 10 * (t - 1)),
                    easeOutExpo: (t) => t === 1 ? 1 : 1 - Math.pow(2, -10 * t),
                    easeInOutExpo: (t) => {
                        if (t === 0) return 0;
                        if (t === 1) return 1;
                        if (t < 0.5) return Math.pow(2, 20 * t - 10) / 2;
                        return (2 - Math.pow(2, -20 * t + 10)) / 2;
                    },
                    easeInBack: (t) => {
                        const c1 = 1.70158;
                        const c3 = c1 + 1;
                        return c3 * t * t * t - c1 * t * t;
                    },
                    easeOutBack: (t) => {
                        const c1 = 1.70158;
                        const c3 = c1 + 1;
                        return 1 + c3 * Math.pow(t - 1, 3) + c1 * Math.pow(t - 1, 2);
                    },
                    easeInOutBack: (t) => {
                        const c1 = 1.70158;
                        const c2 = c1 * 1.525;
                        return t < 0.5
                            ? (Math.pow(2 * t, 2) * ((c2 + 1) * 2 * t - c2)) / 2
                            : (Math.pow(2 * t - 2, 2) * ((c2 + 1) * (t * 2 - 2) + c2) + 2) / 2;
                    },
                    bounce: (t) => {
                        const n1 = 7.5625;
                        const d1 = 2.75;
                        if (t < 1 / d1) {
                            return n1 * t * t;
                        } else if (t < 2 / d1) {
                            return n1 * (t -= 1.5 / d1) * t + 0.75;
                        } else if (t < 2.5 / d1) {
                            return n1 * (t -= 2.25 / d1) * t + 0.9375;
                        } else {
                            return n1 * (t -= 2.625 / d1) * t + 0.984375;
                        }
                    }
                };
                return easings[type] || easings.easeOutQuart;
            }

            // Utility function for throttling scroll events
            throttle(func, delay) {
                let timeoutId;
                let lastExecTime = 0;
                return function (...args) {
                    const currentTime = Date.now();
                    if (currentTime - lastExecTime > delay) {
                        func.apply(this, args);
                        lastExecTime = currentTime;
                    } else {
                        clearTimeout(timeoutId);
                        timeoutId = setTimeout(() => {
                            func.apply(this, args);
                            lastExecTime = Date.now();
                        }, delay - (currentTime - lastExecTime));
                    }
                };
            }

            // Manual trigger method
            trigger(selector) {
                const elements = selector ? document.querySelectorAll(selector) : document.querySelectorAll(this.selector);
                elements.forEach(el => {
                    if (!this.animating.has(el)) {
                        this.animateCounter(el);
                    }
                });
            }

            // Reset method
            reset(selector) {
                const elements = selector ? document.querySelectorAll(selector) : document.querySelectorAll(this.selector);
                elements.forEach(el => {
                    this.animating.delete(el);
                    this.observed.delete(el);
                    const original = parseFloat(el.dataset.originalValue || "0");
                    el.textContent = this.formatNumber(original, el);
                });
            }

            // Cleanup method
            destroy() {
                if (this.observer) {
                    this.observer.disconnect();
                }
                window.removeEventListener('scroll', this.handleScrollFallback);
                this.observed.clear();
                this.animating.clear();
            }

            // Static method for easy initialization
            static init(selector, options) {
                return new ScrollCounter(selector, options);
            }
        }

        // Initialize the counter when DOM is loaded
        let counter;
        document.addEventListener('DOMContentLoaded', () => {
            counter = new ScrollCounter('.counter-value', {
                once: false,  // Allow replay for demo
                replay: true
            });
        });

        // Export for different module systems
        if (typeof module !== 'undefined' && module.exports) {
            module.exports = ScrollCounter;
        } else if (typeof define === 'function' && define.amd) {
            define([], () => ScrollCounter);
        } else {
            window.ScrollCounter = ScrollCounter;
        }
    </script>
</body>
</html>
